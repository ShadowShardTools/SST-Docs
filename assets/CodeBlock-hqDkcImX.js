const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/prism-C1uscOrQ.js","assets/index-BTkkAtaC.js","assets/index-ffn6D79c.css","assets/prism-languages.generated-DQq8CdD0.js","assets/prism-javascript-2LMHe_9g.js","assets/prism-markup-Bufj6vtu.js"])))=>i.map(i=>d[i]);
import{c as b,r as l,_ as g,j as t,B as v,C as P,D as $}from"./index-BTkkAtaC.js";const A=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],M=b("check",A);const O=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],H=b("chevron-up",O);const F=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],V=b("copy",F),j={javascript:{name:"JavaScript",ext:"js"},typescript:{name:"TypeScript",ext:"ts"},python:{name:"Python",ext:"py"},java:{name:"Java",ext:"java"},csharp:{name:"C#",ext:"cs"},cpp:{name:"C++",ext:"cpp"},c:{name:"C",ext:"c"},php:{name:"PHP",ext:"php"},ruby:{name:"Ruby",ext:"rb"},go:{name:"Go",ext:"go"},rust:{name:"Rust",ext:"rs"},swift:{name:"Swift",ext:"swift"},kotlin:{name:"Kotlin",ext:"kt"},scala:{name:"Scala",ext:"scala"},html:{name:"HTML",ext:"html"},css:{name:"CSS",ext:"css"},scss:{name:"SCSS",ext:"scss"},sass:{name:"Sass",ext:"sass"},less:{name:"Less",ext:"less"},json:{name:"JSON",ext:"json"},xml:{name:"XML",ext:"xml"},yaml:{name:"YAML",ext:"yml"},toml:{name:"TOML",ext:"toml"},sql:{name:"SQL",ext:"sql"},bash:{name:"Bash",ext:"sh"},powershell:{name:"PowerShell",ext:"ps1"},dockerfile:{name:"Dockerfile",ext:"dockerfile"},markdown:{name:"Markdown",ext:"md"},latex:{name:"LaTeX",ext:"tex"},plaintext:{name:"Plain Text",ext:"txt"},text:{name:"Text",ext:"txt"}},N=c=>c.replace(/[<>:"/\\|?*]/g,"_").replace(/\s+/g,"_").replace(/_+/g,"_").replace(/^_+|_+$/g,"").slice(0,255),B=(c,o)=>{const e=setTimeout(c,o);return{clear:()=>clearTimeout(e)}},U=async c=>{if(typeof navigator<"u"&&!!navigator.clipboard&&typeof navigator.clipboard.writeText=="function")try{return await navigator.clipboard.writeText(c),!0}catch{}if(typeof document>"u"||typeof document.createElement!="function"||typeof document.body>"u")return!1;const e=document.createElement("textarea");e.value=c,e.setAttribute("readonly","true"),e.style.position="absolute",e.style.left="-9999px",document.body.appendChild(e),e.select();try{return typeof document.execCommand=="function"?document.execCommand("copy"):!1}finally{document.body.removeChild(e)}},I=(c,o,e="text/plain")=>{try{const u=new Blob([c],{type:e}),x=URL.createObjectURL(u),m=document.createElement("a");m.href=x,m.download=N(o),m.style.display="none",document.body.appendChild(m),m.click(),document.body.removeChild(m),setTimeout(()=>URL.revokeObjectURL(x),100)}catch(u){console.error("Failed to download file:",u)}},z=(c,o)=>{const[e,u]=l.useState(!1),x=l.useRef(null),m=l.useRef(new Map),h=l.useRef(null);return l.useEffect(()=>{let s=!0;return(async()=>{try{const r=await g(()=>import("./prism-C1uscOrQ.js").then(p=>p.p),__vite__mapDeps([0,1,2])),f=r.default??r;x.current=f,globalThis.Prism=f,await g(()=>import("./prism-markup-Bufj6vtu.js"),[]),await g(()=>import("./prism-clike-Cik_RNVm.js"),[]),await g(()=>import("./prism-javascript-2LMHe_9g.js"),[]),await g(()=>import("./prism-markup-templating-Ct1xsyfA.js"),[]),await g(()=>import("./prism-languages.generated-DQq8CdD0.js"),__vite__mapDeps([3,4,5])),s&&u(!0)}catch(r){console.warn("Failed to load Prism.js:",r),s&&u(!0)}})(),()=>{s=!1}},[]),l.useEffect(()=>{if(!(!e||!o))return h.current&&clearTimeout(h.current),h.current=setTimeout(async()=>{try{const s=x.current??(await g(async()=>{const{default:d}=await import("./prism-C1uscOrQ.js").then(r=>r.p);return{default:d}},__vite__mapDeps([0,1,2]))).default;if(!s)return;c.forEach((d,r)=>{const f=m.current.get(`${r}`);if(f)try{const p=s.languages[d.language]||s.languages.plaintext;f.innerHTML=s.highlight(d.content,p,d.language)}catch(p){console.warn(`Failed to highlight ${d.language}:`,p),f.textContent=d.content}})}catch(s){console.warn("Failed to highlight code:",s)}},100),()=>{h.current&&clearTimeout(h.current)}},[e,c,o]),{prismLoaded:e,codeRefs:m}},G=({index:c,styles:o,codeData:e,onCopy:u,onLanguageChange:x})=>{const[m,h]=l.useState(null),[s,d]=l.useState(0),[r,f]=l.useState(!!e.defaultCollapsed),p=l.useRef(null),i=l.useMemo(()=>e.sections?.length?e.sections.map(({language:a,...n})=>({language:j[a]?a:"plaintext",...n})):e.content?[{language:j[e.language]?e.language:"plaintext",content:e.content,filename:e.name}]:[],[e]),{prismLoaded:k,codeRefs:T}=z(i,!r),_=i[s],w=l.useCallback(a=>j[a]?.name||a,[]),E=l.useCallback(async a=>{const n=i[a];if(!n)return;await U(n.content)&&(h(`${a}`),p.current&&p.current.clear(),p.current=B(()=>h(null),2e3),u?.(n.content,n.language))},[i,u]),L=l.useCallback(a=>{const n=i[a];if(!n)return;const y=j[n.language]?.ext??"txt",S=n.filename?N(n.filename):`code-${c}-${a}.${y}`;I(n.content,S)},[i,c]),R=l.useCallback(a=>{a>=0&&a<i.length&&(d(a),x?.(i[a].language))},[i,x]);if(l.useEffect(()=>()=>p.current?.clear(),[]),!i.length)return t.jsx("div",{className:"mb-6 p-4 rounded",children:t.jsx("p",{children:"No code content provided"})});const C=i.length>1;return t.jsxs("div",{className:"relative mb-6 overflow-hidden rounded",children:[t.jsxs("div",{className:`flex items-center justify-between px-3 py-2 ${o.code.header}`,children:[t.jsx("div",{className:"flex items-center gap-2 min-w-0 flex-1 flex-wrap",children:C?t.jsxs(t.Fragment,{children:[e.name&&t.jsx("span",{className:"truncate",children:e.name}),t.jsx("div",{className:"flex items-center gap-1 flex-wrap",children:i.map((a,n)=>t.jsx(v,{onClick:()=>R(n),className:"flex justify-center items-center gap-1 py-1 px-2 text-xs",styles:o,variant:n===s?"tabActive":"tab",title:`Switch to ${w(a.language)}`,children:w(a.language)},n))})]}):t.jsx("span",{className:"truncate",children:e.name??_.filename??w(_.language)})}),t.jsxs("div",{className:"flex gap-1 items-center flex-shrink-0",children:[t.jsxs(v,{onClick:()=>f(!r),className:"flex justify-center items-center gap-1 py-1 px-2 text-xs",styles:o,title:r?"Expand code block":"Collapse code block",children:[r?t.jsx(P,{className:"w-3 h-3"}):t.jsx(H,{className:"w-3 h-3"}),t.jsx("span",{className:"hidden sm:inline",children:r?"Show":"Hide"})]}),t.jsxs(v,{onClick:()=>L(s),className:"flex justify-center items-center gap-1 py-1 px-2 text-xs",styles:o,title:"Download code file",children:[t.jsx($,{className:"w-3 h-3"}),t.jsx("span",{className:"hidden sm:inline",children:"Download"})]}),t.jsxs(v,{onClick:()=>E(s),className:"flex justify-center items-center gap-1 py-1 px-2 text-xs",styles:o,title:"Copy code to clipboard",children:[m===`${s}`?t.jsx(M,{className:"w-3 h-3 text-green-500"}):t.jsx(V,{className:"w-3 h-3"}),t.jsx("span",{className:"hidden sm:inline",children:m===`${s}`?"Copied!":"Copy"})]})]})]}),t.jsxs("div",{className:"relative overflow-hidden transition-all duration-300 ease-in-out",style:{maxHeight:r?"0px":e.maxHeight,opacity:r?0:1},children:[t.jsx("pre",{className:`language-${_.language} !m-0 overflow-x-auto w-full text-sm`,style:{maxHeight:e.maxHeight},children:t.jsx("div",{className:"flex min-h-full px-4 py-3",children:t.jsx("div",{className:"flex-1 relative",children:i.map((a,n)=>t.jsx("code",{ref:y=>{y&&(T.current.set(`${n}`,y),k||(y.textContent=a.content))},className:`!language-${a.language} block !p-0 leading-6 ${e.wrapLines?"whitespace-pre-wrap break-words":"whitespace-pre overflow-x-auto"} ${n===s?"block":"hidden"}`,style:{minHeight:"1.5rem",whiteSpace:e.wrapLines?"pre-wrap":"pre",display:n===s?"block":"none"}},n))})})}),!C&&t.jsx("div",{className:`absolute top-2 right-2 px-2 py-1 rounded text-xs backdrop-blur-sm ${o.code.language}`,children:w(_.language)})]})]},c)},q=l.memo(G);export{G as CodeBlock,q as default};
